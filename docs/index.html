<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualización de Datos - Universidad Austral de Chile</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/series-label.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/modules/export-data.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <style>
        /* Estilos adicionales para las secciones */
        .section {
            display: none;
            padding: 20px;
            animation: fadeIn 0.5s;
        }
        .section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .highcharts-figure {
            min-width: 360px; 
            max-width: 1200px;
            margin: 1em auto;
        }
        .chart-container {
            height: 600px;
        }
    </style>
</head>
<body>
    <!-- Header Principal -->
    <header class="main-header">
        <div class="logos-container">
            <img src="thumbnail_Logo observa.png" alt="Universidad Austral de Chile - Centro de Estudios Regionales" class="header-logo-left">
            <img src="thumbnail_images.png" alt="Logo Región" class="header-logo">
        </div>
        <div class="header-content">
            <h1 class="main-title" id="main-title">Análisis de Ventas y Empleo</h1>
            <p class="subtitle" id="subtitle">Universidad Austral de Chile - Centro de Estudios Regionales</p>
        </div>
    </header>
    
    <!-- Navegación -->
    <nav class="nav-container">
        <div class="nav-links" id="nav-links">
            <span class="nav-link active" onclick="showSection('ventas-comuna', this)">Ventas por Comuna</span>
            <span class="nav-link" onclick="showSection('evolucion-ventas', this)">Evolución Ventas</span>
        </div>
    </nav>
    
    <!-- Container Principal -->
    <div class="container">
        
        <!-- Sección 1: Ventas por Comuna -->
        <section id="ventas-comuna" class="section active">
            <h2 class="section-title">Ventas por comuna - Región de Los Ríos (UF, 2024)</h2>
            <figure class="highcharts-figure">
                <div id="container_ventas_comuna" class="chart-container"></div>
            </figure>
        </section>

        <!-- Sección 3: Evolución Ventas -->
        <section id="evolucion-ventas" class="section">
            <h2 class="section-title">Evolución de Ventas Efectivas por Región</h2>
            <figure class="highcharts-figure">
                <div id="container_evolucion_ventas" class="chart-container"></div>
            </figure>
        </section>

    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <p class="footer-text" id="footer-text">
            Desarrollado con Plantilla de Visualización<br>
            Universidad Austral de Chile - Centro de Estudios Regionales
        </p>
        <img src="thumbnail_logo cer.png" alt="Universidad Austral de Chile - Centro de Estudios Regionales" class="footer-logo">
    </footer>

    <script>
        // Lógica de Navegación
        function showSection(sectionId, element) {
            // Ocultar todas las secciones
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            // Mostrar la seleccionada
            document.getElementById(sectionId).classList.add('active');
            
            // Actualizar estado del navbar
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            element.classList.add('active');

            // Reflow de Highcharts para ajustar tamaño al mostrar
            window.dispatchEvent(new Event('resize'));
        }

        // Datos Comunes - Comunas de la Región de Los Ríos
        const categoriesComunas = ["Valdivia", "La Unión", "Panguipulli", "Paillaco", "Río Bueno", "Mariquina", "Futrono", "Los Lagos", "Lanco", "Lago Ranco", "Máfil", "Corral"];
        const uniqueColors = ["#FF5733", "#33FF57", "#3357FF", "#FF33A8", "#33FFF5", "#F3FF33", "#FF8633", "#8E44AD", "#3498DB", "#1ABC9C", "#F1C40F", "#E74C3C"];
        const sourceText = 'Fuente: <a href="https://www.sii.cl/sobre_el_sii/estadisticas_de_empresas.html" target="_blank">SII - Estadísticas de Empresas</a>';

        function getDataWithUniqueColors(values) {
            return values.map((val, index) => ({
                y: val,
                color: uniqueColors[index]
            }));
        }

        // --- Gráfico 1: Ventas por Comuna (Región de Los Ríos) ---
        Highcharts.chart('container_ventas_comuna', {
            chart: { type: 'column' },
            title: { text: 'Ventas totales en UF - Región de Los Ríos (2024)' },
            subtitle: { text: sourceText, align: 'right', verticalAlign: 'bottom', x: -10 },
            xAxis: { categories: categoriesComunas },
            yAxis: { title: { text: 'Ventas (UF)' } },
            credits: { enabled: false },
            plotOptions: { column: { borderRadius: '25%', colorByPoint: true } },
            series: [{
                name: 'Ventas (UF)',
                data: getDataWithUniqueColors([62159243.02, 60081106.05, 12140996.85, 5960339.30, 3919241.92, 2175088.53, 1881338.36, 1854968.08, 1506491.77, 950796.60, 192636.58, 103973.08])
            }]
        });

        // --- Gráfico 3: Evolución Ventas ---
        Highcharts.chart('container_evolucion_ventas', {
            title: { text: 'Evolución de Ventas Efectivas por Región', align: 'center' },
            subtitle: { text: sourceText, align: 'right', verticalAlign: 'bottom', x: -10 },
            yAxis: { title: { text: 'Ventas (UF)' } },
            xAxis: { title: { text: 'Año' }, accessibility: { rangeDescription: 'Rango: 2005 a 2024' } },
            credits: { enabled: false },
            legend: { layout: 'vertical', align: 'right', verticalAlign: 'middle' },
            plotOptions: { series: { label: { enabled: false }, pointStart: 2005 } },
            series: [{
                name: 'Región del Biobío',
                data: [403323367.17, 426042793.89, 444574544.02, 495513268.45, 446813026.59, 464688539.73, 670983237.16, 603119774.2, 595905992.36, 798328620.20, 651573139.63, 679772978.42, 680419934.33, 748228623.28, 813331446.16, 744502830.19, 888072900.84, 1001355286.96, 905546324.31, 941000637.86],
                color: '#FF3355'
            }, {
                name: 'Región de Los Lagos',
                data: [252715548.02, 297884504.86, 315544594.43, 331139439.42, 279966204.19, 304898015.18, 437218663.67, 383449624.52, 513166457.96, 587694058.68, 530190395.59, 524086252.85, 554928117.84, 666262782.51, 818119045.92, 734582698.25, 1011416822.92, 1022607953.42, 1024620662.07, 1090755798.76],
                color: '#33CCFF'
            }, {
                name: 'Región de La Araucanía',
                data: [118105912.25, 190145484.71, 140246506.27, 148483765.19, 144800532.11, 153724209.87, 172722465.82, 184917526.49, 196983241.46, 248138586.4, 223909996.18, 235597355.47, 237232436.11, 251236257.76, 252579820.89, 256799269.57, 319230154.07, 328109939.06, 316713539.32, 307471872.54],
                color: '#33FF99'
            }, {
                name: 'Región de Los Ríos',
                data: [66133956.69, 67390395.53, 77453695.16, 85418636.58, 79038356.2, 84957766.84, 102108744.07, 110348011.47, 105047234.16, 107323290.35, 104216664.92, 108401247.18, 115334579.01, 110675130.58, 115208130.49, 109213244.86, 132060703.04, 151138163.6, 144827859.01, 169832212.13],
                color: '#FFCC00'
            }]
        });

    </script>
</body>
</html>